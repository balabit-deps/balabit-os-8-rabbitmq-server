From f191414dbc2ca738f313bb31e432d57870922892 Mon Sep 17 00:00:00 2001
From: Patrik Ragnarsson <patrik@starkast.net>
Date: Sat, 19 Jun 2021 09:23:12 +0200
Subject: [PATCH] Escape the consumer-tag value in federation mgmt

Patches persistent XSS.
---
 .../priv/www/js/tmpl/federation-upstreams.ejs                   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: rabbitmq-server-3.8.3/deps/rabbitmq_federation_management/priv/www/js/tmpl/federation-upstreams.ejs
===================================================================
--- rabbitmq-server-3.8.3.orig/deps/rabbitmq_federation_management/priv/www/js/tmpl/federation-upstreams.ejs
+++ rabbitmq-server-3.8.3/deps/rabbitmq_federation_management/priv/www/js/tmpl/federation-upstreams.ejs
@@ -45,7 +45,7 @@
      <td class="r"><%= fmt_time(upstream.value['message-ttl'], 'ms') %></td>
      <td class="r"><%= fmt_string(upstream.value['ha-policy']) %></td>
      <td class="r"><%= fmt_string(upstream.value['queue']) %></td>
-     <td class="r"><%= upstream.value['consumer-tag'] %></td>
+     <td class="r"><%= fmt_string(upstream.value['consumer-tag']) %></td>
    </tr>
 <% } %>
  </tbody>
